# RAG Pro Max v1.5.0 手动测试指南

**测试版本**: v1.5.0  
**测试日期**: 待定  
**测试人**: 待定

---

## 🎯 测试目的

验证 v1.5.0 的所有新功能和改进是否正常工作，确保：
1. 新功能可用
2. 现有功能不受影响
3. 性能有提升
4. 无明显 bug

---

## 📋 测试前准备

### 1. 切换到测试分支

```bash
cd /Users/zhaosj/Documents/rag-pro-max
git checkout v1.5-complete-refactor
```

### 2. 备份当前数据（重要！）

```bash
# 备份知识库
cp -r vector_db_storage vector_db_storage_backup

# 备份聊天历史
cp -r chat_histories chat_histories_backup

# 备份配置
cp -r config config_backup
```

### 3. 启动应用

```bash
streamlit run src/apppro.py
```

---

## 🧪 测试场景

### 场景 1: 基础功能测试（必须通过）

#### 1.1 创建知识库
- [ ] 打开应用
- [ ] 输入知识库名称: `test_v150_kb`
- [ ] 点击"创建新知识库"
- [ ] **预期**: 创建成功，显示成功提示

#### 1.2 上传文档
- [ ] 选择刚创建的知识库
- [ ] 上传一个 PDF 文件
- [ ] **预期**: 上传成功，显示处理进度
- [ ] **检查**: 文档列表中显示该文件

#### 1.3 查询对话
- [ ] 输入问题: "这个文档讲了什么？"
- [ ] **预期**: 返回相关回答
- [ ] **检查**: 显示引用来源
- [ ] **检查**: 显示推荐问题

#### 1.4 推荐问题
- [ ] 查看推荐问题列表
- [ ] 点击一个推荐问题
- [ ] **预期**: 自动提问并返回回答

**结果**: [ ] 通过 [ ] 失败

**问题记录**:
```
（如有问题，在此记录）
```

---

### 场景 2: 查询缓存测试（新功能）

#### 2.1 首次查询
- [ ] 输入问题: "什么是机器学习？"
- [ ] 记录查询时间: ___秒
- [ ] **预期**: 正常返回回答

#### 2.2 重复查询
- [ ] 再次输入相同问题: "什么是机器学习？"
- [ ] 记录查询时间: ___秒
- [ ] **预期**: 查询时间明显缩短（应该 < 1秒）

#### 2.3 缓存验证
- [ ] 查看终端日志
- [ ] **检查**: 是否有缓存相关日志
- [ ] **预期**: 第二次查询使用了缓存

**结果**: [ ] 通过 [ ] 失败

**性能数据**:
- 首次查询: ___秒
- 重复查询: ___秒
- 提升比例: ___%

---

### 场景 3: 错误处理测试（新功能）

#### 3.1 文件不存在错误
- [ ] 尝试上传一个不存在的文件（如果可能）
- [ ] **预期**: 显示友好的错误提示
- [ ] **检查**: 是否有恢复建议

#### 3.2 配置错误
- [ ] 清空 API Key
- [ ] 尝试查询
- [ ] **预期**: 显示友好的错误提示
- [ ] **检查**: 提示如何配置 API Key

#### 3.3 网络错误
- [ ] 断开网络（如果使用在线 API）
- [ ] 尝试查询
- [ ] **预期**: 显示友好的错误提示
- [ ] **检查**: 提示检查网络连接

**结果**: [ ] 通过 [ ] 失败

**错误提示示例**:
```
（记录实际看到的错误提示）
```

---

### 场景 4: 日志功能测试（扩展功能）

#### 4.1 查看终端日志
- [ ] 执行一次完整的查询流程
- [ ] 查看终端输出
- [ ] **检查**: 日志格式是否清晰
- [ ] **检查**: 是否有时间戳
- [ ] **检查**: 是否有阶段标识

#### 4.2 查看日志文件
- [ ] 打开 `app_logs/log_YYYYMMDD.jsonl`
- [ ] **检查**: 日志内容是否完整
- [ ] **检查**: JSON 格式是否正确

**结果**: [ ] 通过 [ ] 失败

---

### 场景 5: 兼容性测试（重要）

#### 5.1 使用 v1.4.4 的知识库
- [ ] 恢复 v1.4.4 的知识库备份
- [ ] 在 v1.5.0 中选择该知识库
- [ ] 尝试查询
- [ ] **预期**: 正常工作，无需迁移

#### 5.2 使用 v1.4.4 的配置
- [ ] 恢复 v1.4.4 的配置文件
- [ ] 重启应用
- [ ] **预期**: 配置正常加载

#### 5.3 使用 v1.4.4 的聊天历史
- [ ] 恢复 v1.4.4 的聊天历史
- [ ] 查看历史记录
- [ ] **预期**: 历史记录正常显示

**结果**: [ ] 通过 [ ] 失败

---

### 场景 6: 性能测试

#### 6.1 启动时间
- [ ] 完全退出应用
- [ ] 记录启动时间: ___秒
- [ ] **对比 v1.4.4**: ___秒
- [ ] **预期**: 差异 < 2秒

#### 6.2 内存占用
- [ ] 启动后查看内存: ___MB
- [ ] 查询后查看内存: ___MB
- [ ] 多次查询后: ___MB
- [ ] **预期**: 增长 < 100MB

#### 6.3 查询速度
- [ ] 首次查询: ___秒
- [ ] 重复查询: ___秒
- [ ] 不同问题: ___秒
- [ ] **预期**: 重复查询明显更快

**结果**: [ ] 通过 [ ] 失败

---

### 场景 7: 压力测试（可选）

#### 7.1 连续查询
- [ ] 连续查询 10 次
- [ ] **检查**: 应用是否稳定
- [ ] **检查**: 内存是否持续增长
- [ ] **检查**: 响应速度是否下降

#### 7.2 大文件上传
- [ ] 上传一个大文件（> 50MB）
- [ ] **检查**: 是否正常处理
- [ ] **检查**: 是否有内存溢出

#### 7.3 多知识库切换
- [ ] 创建 3 个知识库
- [ ] 频繁切换
- [ ] **检查**: 切换是否流畅
- [ ] **检查**: 是否有数据混乱

**结果**: [ ] 通过 [ ] 失败

---

## 📊 测试结果汇总

### 测试统计
- 总场景数: 7
- 通过场景: ___
- 失败场景: ___
- 通过率: ___%

### 关键指标

| 指标 | v1.4.4 | v1.5.0 | 变化 |
|------|--------|--------|------|
| 启动时间 | ___ | ___ | ___ |
| 首次查询 | ___ | ___ | ___ |
| 重复查询 | ___ | ___ | ___ |
| 内存占用 | ___ | ___ | ___ |

### 发现的问题

#### 严重问题（阻止发布）
1. 
2. 

#### 一般问题（可以发布后修复）
1. 
2. 

#### 建议改进
1. 
2. 

---

## 🎯 测试结论

### 总体评价
- [ ] ✅ 优秀 - 所有功能正常，性能提升明显
- [ ] ✅ 良好 - 功能正常，有小问题但不影响使用
- [ ] ⚠️ 一般 - 有一些问题需要修复
- [ ] ❌ 不合格 - 有严重问题，不能发布

### 是否推荐发布
- [ ] ✅ 推荐发布
- [ ] ⚠️ 修复问题后发布
- [ ] ❌ 不推荐发布

### 测试人签名
- 测试人: ___________
- 测试日期: ___________
- 测试时长: ___________

---

## 📝 附加说明

### 测试环境
- 操作系统: ___________
- Python 版本: ___________
- 依赖版本: ___________

### 测试数据
- 测试文档: ___________
- 测试问题: ___________

### 其他备注
```
（其他需要说明的内容）
```

---

## 🔄 测试后操作

### 如果测试通过
```bash
# 1. 合并到 main
git checkout main
git merge v1.5-complete-refactor

# 2. 创建标签
git tag -a v1.5.0 -m "Release v1.5.0"

# 3. 推送
git push origin main --tags
```

### 如果测试失败
```bash
# 1. 回到 main 分支
git checkout main

# 2. 保留测试分支供修复
# v1.5-complete-refactor 分支保留

# 3. 记录问题，等待修复
```

### 恢复备份（如果需要）
```bash
# 恢复知识库
rm -rf vector_db_storage
mv vector_db_storage_backup vector_db_storage

# 恢复聊天历史
rm -rf chat_histories
mv chat_histories_backup chat_histories

# 恢复配置
rm -rf config
mv config_backup config
```

---

**创建日期**: 2025-12-09  
**文档版本**: 1.0
