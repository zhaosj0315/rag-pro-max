# RAG Pro Max v1.5.1 发布说明

**发布日期**: 2025-12-09  
**版本类型**: 功能增强版本  
**状态**: ✅ 稳定可用

---

## 🎯 版本概述

v1.5.1 是 v1.5.0 的功能增强版本，专注于用户体验优化和系统可用性提升。

### 核心改进
1. **性能监控** - 实时查看查询性能和统计信息
2. **推荐优化** - 自定义推荐问题，历史记录管理
3. **错误恢复** - 自动重试机制，友好错误提示

---

## 🚀 新增功能

### 1. 性能监控面板
**位置**: 侧边栏 → 📊 性能监控

**功能**:
- 查询性能统计（平均/最快/最慢耗时）
- 查询统计（总查询数、总耗时）
- 最近查询详情（耗时、检索文档数）
- 刷新和清空操作

**使用场景**:
- 监控系统性能
- 优化查询效率
- 分析查询瓶颈

**技术实现**:
- 利用 LogManager 的性能指标
- 轻量级实现（100行代码）
- 无侵入式集成

---

### 2. 推荐问题优化
**位置**: 侧边栏 → 💡 推荐问题管理

**功能**:
- **自定义推荐**: 添加/删除自定义推荐问题
- **历史记录**: 查看最近生成的推荐问题
- **统计信息**: 自定义数量、历史数量、队列数量
- **持久化存储**: 推荐问题自动保存到磁盘

**使用场景**:
- 为知识库预设常见问题
- 引导用户提问方向
- 提升用户体验

**技术实现**:
- 扩展 SuggestionEngine（+80行）
- 新增 SuggestionPanel UI（130行）
- JSON 格式持久化存储

---

### 3. 错误恢复机制
**功能**:
- **自动重试**: 可配置重试次数、延迟、倍增因子
- **友好提示**: 9种常见错误的友好消息
- **恢复建议**: 针对性的解决方案
- **装饰器支持**: `@retry_on_error` 和 `@handle_errors`

**支持的错误类型**:
- FileNotFoundError - 文件未找到
- PermissionError - 权限不足
- ValueError - 数据格式错误
- KeyError - 配置项缺失
- ConnectionError - 网络连接失败
- TimeoutError - 操作超时
- MemoryError - 内存不足
- AttributeError - 对象属性错误
- ImportError - 模块导入失败

**使用示例**:
```python
from src.utils.error_handler import retry_on_error

@retry_on_error(max_retries=3, delay=1.0, backoff=2.0)
def unstable_function():
    # 可能失败的操作
    pass
```

**技术实现**:
- 扩展 ErrorHandler（+70行）
- 指数退避重试策略
- 上下文感知错误消息

---

## 📊 测试结果

### 可行性测试
- ✅ 通过: **6/6**
- ❌ 失败: **0/6**

### 出厂测试
- ✅ 通过: **58/63**
- ❌ 失败: **0/63**
- ⏭️ 跳过: **5/63**

### 功能测试
- ✅ 性能监控面板正常
- ✅ 推荐问题管理正常
- ✅ 错误恢复机制正常
- ✅ 所有现有功能正常

---

## 📝 代码统计

### 新增文件
- `src/ui/performance_monitor.py` (100行)
- `src/ui/suggestion_panel.py` (130行)
- `suggestion_history/` (历史存储目录)

### 修改文件
- `src/chat/suggestion_engine.py` (+80行)
- `src/utils/error_handler.py` (+70行)
- `.gitignore` (添加 suggestion_history)

### 总计
- 新增: **+380 行**
- 修改: **+120 行**
- 总计: **+500 行**

---

## 🎯 使用指南

### 性能监控
1. 启动应用
2. 在侧边栏找到 **📊 性能监控**
3. 进行对话查询
4. 查看性能统计

### 推荐问题管理
1. 选择知识库
2. 在侧边栏找到 **💡 推荐问题管理**
3. 在"自定义推荐"标签添加问题
4. 自定义问题会优先显示

### 错误恢复
- 系统自动处理错误
- 显示友好错误消息
- 提供恢复建议
- 自动重试失败操作

---

## 🔄 升级说明

### 从 v1.5.0 升级
1. 拉取最新代码：`git pull origin main`
2. 无需额外配置
3. 重启应用即可使用新功能

### 兼容性
- ✅ 完全向后兼容 v1.5.0
- ✅ 不影响现有功能
- ✅ 不需要重建知识库

---

## 📚 相关文档

- [v1.5.0 发布说明](RELEASE_v1.5.0.md)
- [v1.5.1 可行性测试](tests/test_v1.5.1_feasibility.py)
- [更新日志](CHANGELOG.md)
- [README.md](README.md)

---

## 🎯 下一步计划

### v1.5.2 (计划中)
- [ ] 查询缓存持久化
- [ ] 性能优化
- [ ] UI/UX 改进

---

## 🙏 致谢

感谢所有用户的反馈和建议！

---

**发布负责人**: AI Assistant  
**审核日期**: 2025-12-09  
**发布日期**: 2025-12-09
