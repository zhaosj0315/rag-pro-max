# 网页爬取关键词搜索修复说明

## 问题描述

用户在使用关键词搜索功能时，搜索"卵巢癌"等医学关键词却得到了大量技术相关的文档（如CSDN、GitHub、Stack Overflow的内容）。

## 问题原因

1. **预设网站配置过于宽泛**：系统预设了6个网站，包括技术类网站（CSDN、GitHub、Stack Overflow）
2. **缺少网站分类**：所有网站混在一起显示，用户容易误选不相关的网站
3. **没有智能推荐**：系统不会根据关键词类型推荐合适的网站

## 修复方案

### 1. 网站分类标注 (`web_to_kb_processor.py`)

为每个预设网站添加 `category` 字段，将网站分为三类：
- **百科类**：维基百科、百度百科
- **问答类**：知乎
- **技术类**：CSDN、GitHub、Stack Overflow

同时为技术类网站添加警告信息：
```python
"description": "CSDN - 技术博客平台 ⚠️ 仅适用于技术类搜索"
```

### 2. 智能网站推荐 (`web_to_kb_processor.py`)

新增 `recommend_sites_for_keyword()` 方法，根据关键词智能推荐合适的网站：

- **医学关键词**（如：卵巢癌、肺癌、糖尿病等）
  - 推荐：维基百科、百度百科、知乎
  - 排除：技术类网站

- **技术关键词**（如：Python、机器学习、Docker等）
  - 推荐：维基百科、知乎、CSDN、GitHub、Stack Overflow

- **一般关键词**（如：历史、文学、经济等）
  - 推荐：维基百科、百度百科、知乎

### 3. UI界面优化 (`web_to_kb_interface.py`)

#### 3.1 按类别分组显示
将网站选择区域按类别分组：
- 百科类网站（推荐用于一般搜索）
- 问答类网站
- 技术类网站（特别标注警告）

#### 3.2 智能推荐提示
当用户输入关键词后，显示智能推荐信息：
```
💡 根据关键词 '卵巢癌' 智能推荐网站: 维基百科, 百度百科, 知乎
```

#### 3.3 自动选中推荐网站
根据智能推荐结果，自动勾选合适的网站，避免用户误选。

## 修改文件清单

1. `src/processors/web_to_kb_processor.py`
   - 添加网站分类标注
   - 新增 `recommend_sites_for_keyword()` 方法

2. `src/ui/web_to_kb_interface.py`
   - 优化网站选择界面，按类别分组
   - 添加智能推荐提示
   - 根据推荐自动选中网站

3. `test_site_recommendation.py`（新增）
   - 测试脚本，验证推荐功能

## 测试结果

```
关键词: 卵巢癌     | 类别: 医学 | 推荐: 维基百科, 百度百科, 知乎
关键词: Python编程 | 类别: 技术 | 推荐: 维基百科, 知乎, CSDN, GitHub, Stack Overflow
关键词: 历史文化   | 类别: 一般 | 推荐: 维基百科, 百度百科, 知乎
```

## 使用建议

1. **医学/健康类搜索**：只选择百科和问答类网站
2. **技术/编程类搜索**：可以选择技术类网站
3. **一般知识搜索**：使用默认推荐的百科类网站
4. **注意警告提示**：技术类网站会显示警告，提醒用户适用范围

## 预期效果

- ✅ 医学关键词不再返回技术文档
- ✅ 用户界面更清晰，分类明确
- ✅ 智能推荐减少误操作
- ✅ 搜索结果更精准相关

---

**修复日期**: 2025-12-21  
**版本**: v2.4.8  
**修复人**: Kiro AI Assistant
