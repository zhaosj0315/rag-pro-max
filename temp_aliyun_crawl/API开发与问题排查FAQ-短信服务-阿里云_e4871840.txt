URL: https://help.aliyun.com/zh/sms/developer-reference/api-sdk-faq
标题: API开发与问题排查FAQ-短信服务-阿里云
内容长度: 4498 字符
==================================================

您在使用短信服务
API
或
SDK
时，如果遇到疑问后可以参考以下常见问题及处理建议。
高频问题
为什么阿里云控制台无法再次查看我的
RAM
用户的
AccessKey Secret？
短信服务
RPC
方式中签名生成示例？
短信服务公网
IP
调用接口提示拒绝访问该怎么办？
QuerySendDetails
接口中的
TotalCount
字段和控制台中的条数有什么区别？
短信发送失败，返回错误码
isv.SMS_TEST_NUMBER_LIMIT，什么原因？
短信服务发送接口是否支持内网调用？
短信服务接口是否需要相互加白
IP？
如何自定义封装
HTTP
请求，然后使用
curl
命令或
Postman
等工具进行
API
调用？
AccessKey
与
RAM
账号相关问题
AccessKey
是否支持调用短信
API？
短信服务密钥会泄露吗？
短信服务
AccessKey
和
RAM
账号有什么区别？
短信服务如何查看
AccessKey？
接口调用前准备工作相关问题
短信服务使用
STS
鉴权方式初始化账号
Client，如何配置和获取
securityToken？
短信服务
RPC
方式中签名生成示例？
短信服务公网
IP
调用接口提示拒绝访问该怎么办？
短信服务
HTTP
拼接支持
ROA
调用机制吗？
短信服务
API
调用阿里云的
IP
服务器地址是固定的吗？
短信服务发送接口是否支持内网调用？
短信服务接口是否需要相互加白
IP？
接口调用与返回值相关问题
国际短信
API
返回
ServiceUnavailable
是什么原因？
短信服务下发报错
Specified parameter Version is not valid，什么原因？
短信服务下发失败报错黑名单管控，什么原因？
短信服务
API
接口中
BizId
参数的作用？
提交模板时报错
SmsContent.Illegal，怎么处理？
短信发送失败，返回错误码
isv.SMS_TEST_NUMBER_LIMIT，什么原因？
为什么阿里云控制台无法再次查看我的
RAM
用户的
AccessKey Secret？
RAM
用户的
AccessKey Secret
只能在
创建
AccessKey
时显示，创建完成后不支持查看。请在创建好
AccessKey
后，及时并妥善保存
AccessKey Secret。更多相关操作，请参见
查看
RAM
用户的
AccessKey
信息
。
AccessKey
是否支持调用短信
API？
AccessKey
是阿里云账号维度，并不固定用于阿里云哪个产品。
如果您是
RAM
子账号的
AccessKey，为对应的
RAM
子账号授权了哪些产品的权限，对应的
AccessKey
就可以调用对应产品的
API
接口。您可以在
RAM-用户
页面，为账号添加权限，更多操作请参见
RAM 用户
。
国际短信
API
返回
ServiceUnavailable
是什么原因？
如果您调用国际短信
API
接口返回
ServiceUnavailable，可能因为您使用了国内短信的域名或模板，
国内短信域名为
dysmsapi.aliyuncs.com
，国际短信域名为
dysmsapi.ap-southeast-1.aliyuncs.com
。另外请使用国际短信模板发送短信。
短信服务使用
STS
鉴权方式初始化账号
Client，如何配置和获取
securityToken？
您可使用
安全令牌
的方式进行配置和获取临时身份。
QuerySendDetails
接口中的
TotalCount
字段和控制台中的条数有什么区别？
TotalCount
字段指短信发送总条数，是根据您传入的号码查询到的发送记录，控制台
发送记录查询
页面显示的条数是根据
短信发送规则
拆分成的短信条数。
短信服务
RPC
方式中签名生成示例？
该阶段的签名与短信服务发送短信时的签名不同，主要是为了保证
API
的安全使用，在调用
API
时阿里云会对每个
API
请求通过签名（Signature）进行身份验证。具体的签名生成步骤和签名生成示例请参见
签名示例代码
。
短信服务公网
IP
调用接口提示拒绝访问该怎么办？
建议检查服务器内能否正常
ping
通和
curl dysmsapi.aliyuncs.com ，以及服务器
80/443
端口是否正常放行。
短信服务下发报错
Specified parameter Version is not valid，什么原因？
原因
：API
的版本号（Version）错误。请确认接口的版本号。
短信服务的
API
版本号（Version）为
2017-05-25。详情请参见
集成概览
。
短信服务下发失败报错黑名单管控，什么原因？
黑名单管控主要指接收短信的号码为黑名单号码，此类号码曾有过退订或投诉记录不支持下发该内容的短信。建议规避该号码重新发送。
重要
在未完全完成报备之前，您的短信可能会发送失败，返回错误码如下：
PORT_NOT_REGISTERED
：当前使用端口号尚未完成企业实名制报备流程。
运营商实名报备流程平均需要
5-7
个工作日，基于近期观测，部分运营商实名报备流程需要
7-10
个工作日
，但运营商未对此时效进行承诺，
实际可能需要更长时间
。
请您合理规划业务计划，并在正式使用前提前申请相关资质和签名，预留时间进行发送测试，以确保在正式使用前有充足的时间完成实名报备。
短信服务
HTTP
拼接支持
ROA
调用机制吗？
若您接入短信服务时无法满足
SDK
使用条件，可使用
HTTP
拼接方式接入，目前
HTTP
拼接只支持
RPC
风格，不支持
ROA
调用机制。详情请参见
V3
版本请求体&签名机制
。
短信服务
API
接口中
BizId
参数的作用？
BizId
指发送回执
ID，同一个阿里云账号，每条发送记录对应的
BizId
是不同的；不同的阿里云账号之间，BizId
有极少情况下会相同。BizId
作用是调用
QuerySendDetails
接口时，根据
BizId
的值来查询具体的发送状态。
短信服务密钥会泄露吗？
短信服务通过
AccessKey
调用接口发送短信，如果您的
AccessKey
存在泄露的情况，建议您重新生成
AccessKey
后，禁用或者删除原
AccessKey，删除和禁用前需要确认业务没有使用此
AccessKey。更多详情请参见
凭据的安全使用方案
。
短信服务
API
调用阿里云的
IP
服务器地址是固定的吗？
短信服务接口对外只提供域名地址形式，没有提供固定的调用
IP
地址。请使用全局接入点域名
dysmsapi.aliyuncs.com
。
更多接入点信息请参见
服务接入点
。
短信服务
AccessKey
和
RAM
账号有什么区别？
AccessKey
是阿里云账号创建的一个访问密钥，调用阿里云
API
接口时，用来完成账号的身份验证。一个阿里云账号可以创建多个
AccessKey。RAM
账号是阿里云子账号，需要被主账号授权后才可以正常使用。更多详情请参见
RAM 用户
、
AccessKey
。
短信服务如何查看
AccessKey？
您可以在控制台
查看
AccessKey ID
。AccessKey Secret
只能在
创建
AccessKey
时显示，创建完成后不支持查看。请在创建好
AccessKey
后，及时并妥善保存
AccessKey Secret。更多相关操作，请参见
查看
RAM
用户的
AccessKey
信息
。
提交模板时报错
SmsContent.Illegal，怎么处理？
短信服务提交模板报错“模板内容非法”，错误码“smscontentillegal”。一般是模板内容含有：特殊符号、中括号、繁体字或错别字、变异字等导致。建议按
短信模板规范
修改模板内容后再重新提交审核。若还提示错误，请检查您的账号是否存在违反用户协议以及平台管理规则中对内容管制相关规定的行为。更多详情也可查看
服务协议
。
重要
如果出现违法违规或者损害到相关他人权益的，短信服务将保留最终追究的权利！请各会员严格遵守规范要求，加强自身业务安全，发送合规短信。
短信发送失败，返回错误码
isv.SMS_TEST_NUMBER_LIMIT
，什么原因？
遇到错误提示
isv.SMS_TEST_NUMBER_LIMIT
，表示
只能向已绑定的测试手机号发送短信
。如您已将当前接收号码绑定，但仍收到此错误码提示。请根据以下原因及解决方案排查：
原因
接收测试短信号码未在控制台绑定，或绑定过程未完成、未生效。
接口调用与绑定手机号不匹配。
如您在生产环境遇到此错误码，请排查您是否将测试环境与生产环境混淆。
解决方案
通过测试功能发送短信，需要绑定测试手机号才可以发送。
请确认绑定操作已完成并且已生效。有时系统处理或同步可能会有延时。
请检查在
API
请求或控制台调用中指定的手机号是否与在控制台绑定的测试手机号完全一致，包括国家码和格式。
测试签名和模板（在控制台显示有绿色“测”标记）会限制发送对象仅为已绑定的测试号码。请确保在正式发送短信时使用的是非测试的签名和模板。
完整的错误码列表及原因与解决方案，请参见
API
错误码
。
短信服务发送接口是否支持内网调用？
短信服务调用接口都是统一访问阿里云域名发送短信，规范网络环境能正常访问阿里云域名即可，需要公网调用，详情请参见短信服务
API
文档
。
如果您的服务器有内网等网络限制无法调通短信接口报错“连接超时”，建议添加短信服务的公网接入地址
dysmsapi.aliyuncs.com
到白名单；若还是无法发送短信，可以尝试调整本地防火墙配置或者检查连接超时时间是否设置过大。
短信服务接口是否需要相互加白
IP？
发送短信的公网调用的接口域名地址为
dysmsapi.aliyuncs.com
，HTTP
调用使用端口为
80，HTTPS
调用使用端口为
443。
调用短信服务的
API
接口前，您的
IP
网络不必报备至阿里云侧。只要能
ping
通
dysmsapi.aliyuncs.com
即可，其对应的
IP
段不固定且不定期变更，若您的网络环境特殊，建议您安全策略方面调整为放行该域名。
如何自定义封装
HTTP
请求，然后使用
curl
命令或
Postman
等工具进行
API
调用？
阿里云
SDK
已经封装了签名、超时、重试等机制，我们建议您使用
SDK
进行集成，降低开发成本。如果您需要自行封装请求来进行
API
测试，请参见
V3
版签名机制
和
SendSms
请求示例
。
上一篇：短信发送状态回执错误码
下一篇：服务支持
该文章对您有帮助吗？
反馈