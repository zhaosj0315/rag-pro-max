#!/bin/bash

# RAG Pro Max v2.3.0 å¯åŠ¨å™¨
cd "$(dirname "$0")"

echo "ğŸš€ RAG Pro Max v2.3.0 - æ™ºèƒ½ç›‘æ§ç‰ˆ"
echo "=================================="

# å¿«é€Ÿå¯åŠ¨
if [ "$1" = "start" ] || [ "$1" = "" ]; then
    echo "ğŸ“Š å¯åŠ¨æ™ºèƒ½ç›‘æ§ç‰ˆ..."
    streamlit run src/apppro.py --server.port 8501
    
elif [ "$1" = "test" ]; then
    echo "ğŸ§ª è¿è¡ŒåŠŸèƒ½æµ‹è¯•..."
    python test_v2.3.0_features.py
    
elif [ "$1" = "monitor" ]; then
    echo "ğŸ“Š æŸ¥çœ‹ç³»ç»Ÿç›‘æ§..."
    python -c "
from src.utils.smart_scheduler import get_smart_scheduler
from src.utils.alert_system import get_alert_system
import psutil

scheduler = get_smart_scheduler()
alert_system = get_alert_system()

print('ğŸ“Š ç³»ç»ŸçŠ¶æ€:')
print(f'  CPU: {psutil.cpu_percent()}%')
print(f'  å†…å­˜: {psutil.virtual_memory().percent}%')

config = scheduler.get_optimal_workers()
print(f'ğŸ“‹ æ¨èé…ç½®:')
print(f'  CPUå·¥ä½œçº¿ç¨‹: {config[\"cpu_workers\"]}')
print(f'  IOå·¥ä½œçº¿ç¨‹: {config[\"io_workers\"]}')
print(f'  è´Ÿè½½ç­‰çº§: {config[\"load_level\"]}')
"

else
    echo "ç”¨æ³•: rag [start|test|monitor]"
    echo "  start   - å¯åŠ¨åº”ç”¨ (é»˜è®¤)"
    echo "  test    - è¿è¡ŒåŠŸèƒ½æµ‹è¯•"  
    echo "  monitor - æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€"
fi
